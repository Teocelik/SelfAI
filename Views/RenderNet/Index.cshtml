<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>AI Image Generation Studio</title>
    <link rel="stylesheet" href="../css/main.css" />
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet" />
    <script type="module" src="https://static.rocket.new/rocket-web.js?_cfg=https%3A%2F%2Faiimageg6696back.builtwithrocket.new&_be=https%3A%2F%2Fapplication.rocket.new&_v=0.1.6"></script>
</head>
<body class="bg-background text-text-primary min-h-screen">
    <!-- Main Container -->
    <div class="flex h-screen w-full">
        <!-- Main Canvas Area -->
        <div class="flex-1 p-6 overflow-hidden order-1 transition-all duration-300 ease-out" id="mainCanvas">
            <!-- Header -->
            <header class="mb-6">
                <div class="flex items-center justify-between">
                    <div class="flex items-center space-x-3">
                        <div class="w-8 h-8 bg-gradient-to-br from-primary to-secondary rounded-lg flex items-center justify-center">
                            <i class="fas fa-magic text-white text-sm"></i>
                        </div>
                        <h1 class="text-2xl font-semibold text-text-primary">AI Image Generation Studio</h1>
                    </div>
                    <div class="flex items-center space-x-4">
                        <button class="p-2 hover:bg-surface rounded-lg transition-colors duration-200">
                            <i class="fas fa-history text-text-secondary hover:text-text-primary"></i>
                        </button>
                        <button class="p-2 hover:bg-surface rounded-lg transition-colors duration-200">
                            <i class="fas fa-cog text-text-secondary hover:text-text-primary"></i>
                        </button>
                    </div>
                </div>
            </header>

            <!-- Canvas Area -->
            <div class="bg-surface rounded-xl border border-border p-8 h-full max-h-[calc(100vh-140px)] flex items-center justify-center relative overflow-hidden">
                <!-- Default State -->
                <div id="defaultState" class="text-center">
                    <div class="w-24 h-24 bg-surface-elevated rounded-full flex items-center justify-center mb-6 mx-auto">
                        <i class="fas fa-image text-4xl text-text-secondary"></i>
                    </div>
                    <h3 class="text-xl font-medium text-text-primary mb-2">Create Your First AI Image</h3>
                    <p class="text-text-secondary mb-6 max-w-md">Enter a detailed prompt in the sidebar to generate stunning AI-powered images. Customize style, aspect ratio, and more.</p>
                    <div class="flex items-center justify-center space-x-2 text-text-muted">
                        <i class="fas fa-arrow-right text-sm"></i>
                        <span class="text-sm">Use the controls on the right to get started</span>
                    </div>
                </div>

                <!-- Loading State (Hidden by default) -->
                <div id="loadingState" class="text-center hidden">
                    <div class="w-16 h-16 border-4 border-surface-elevated border-t-primary rounded-full animate-spin mb-6 mx-auto"></div>
                    <h3 class="text-xl font-medium text-text-primary mb-2">Generating Your Image</h3>
                    <p class="text-text-secondary mb-4">This may take a few moments...</p>
                    <div class="w-64 bg-surface-elevated rounded-full h-2 mx-auto">
                        <div class="bg-gradient-to-r from-primary to-secondary h-2 rounded-full animate-pulse" style="width: 45%"></div>
                    </div>
                </div>

                <!-- Generated Image Container (Hidden by default) -->
                <div id="imageContainer" class="hidden w-full h-full flex items-center justify-center">
                    <div class="relative max-w-full max-h-full">
                        <img id="generatedImage" src alt="Generated AI Image" class="max-w-full max-h-full object-contain rounded-lg shadow-lg" />
                        <div class="absolute top-4 right-4 flex space-x-2">
                            <button class="bg-surface/80 backdrop-blur-sm p-2 rounded-lg hover:bg-surface transition-colors duration-200">
                                <i class="fas fa-download text-text-primary"></i>
                            </button>
                            <button class="bg-surface/80 backdrop-blur-sm p-2 rounded-lg hover:bg-surface transition-colors duration-200">
                                <i class="fas fa-share text-text-primary"></i>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Flux Image Style Panel - Side Panel -->
       
        <div id="fluxStylePanel" class="fixed top-[100px] h-auto max-h-[600px] w-[550px] bg-surface border border-border rounded-xl shadow-2xl z-40 transform translate-x-full opacity-0 transition-all duration-300 ease-out hidden" style="right: 400px;">
            <div class="h-full flex flex-col rounded-xl overflow-hidden">
                <!-- Panel Header -->
                <div class="p-4 border-b border-border flex items-center justify-between flex-shrink-0">
                    <span class="text-sm font-semibold text-text-primary">Image Reference Style</span>
                    <button type="button" id="closeFluxPanelBtn" class="w-7 h-7 flex items-center justify-center rounded-lg hover:bg-surface-elevated transition-colors duration-200">
                        <i class="fas fa-times text-text-secondary hover:text-text-primary text-sm"></i>
                    </button>
                </div>

                <!-- Panel Content - Scrollable -->
                <div class="flex-1 overflow-y-auto custom-scrollbar">
                    <!-- Upload Section -->
                    <div class="px-4 py-3 border-b border-border">
                        <div class="flex items-center justify-center space-x-2 py-3 border-2 border-dashed border-border rounded-lg hover:border-primary/50 transition-colors duration-200 cursor-pointer" id="styleUploadArea">
                            <input type="file" id="styleImageInput" name="StyleImage" accept="image/*" class="hidden" />
                            <div id="styleUploadContent" class="flex items-center space-x-2">
                                <i class="fas fa-cloud-upload-alt text-text-secondary"></i>
                                <span class="text-sm text-text-primary">Upload a style reference image</span>
                            </div>
                            <div id="styleUploadPreview" class="hidden flex items-center space-x-3">
                                <img id="styleUploadPreviewImg" src="" alt="Uploaded Style" class="w-10 h-10 object-cover rounded-lg" />
                                <span class="text-sm text-text-primary">Uploaded</span>
                                <button type="button" id="removeUploadedStyle" class="text-xs text-error hover:text-error-600 transition-colors duration-200">
                                    <i class="fas fa-times"></i>
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Style Examples Section -->
                    <div class="p-4">
                        <p class="text-xs text-text-secondary mb-4">Select a style reference image from below</p>
                        <div class="grid grid-cols-3 gap-4" id="styleExamplesGrid">
                            <div class="style-option cursor-pointer group" data-style="neon-portrait" data-name="Neon Portrait" data-img="https://images.unsplash.com/photo-1534528741775-53994a69daeb?w=200&h=280&fit=crop&crop=face">
                                <div class="aspect-[3/4] rounded-lg overflow-hidden border-2 border-transparent hover:border-primary transition-all duration-200">
                                    <img src="https://images.unsplash.com/photo-1534528741775-53994a69daeb?w=200&h=280&fit=crop&crop=face" alt="Neon Portrait" class="w-full h-full object-cover" />
                                </div>
                                <p class="text-xs text-center text-text-secondary mt-2 group-hover:text-text-primary">Neon Portrait</p>
                            </div>
                            <div class="style-option cursor-pointer group" data-style="cinematic" data-name="Cinematic" data-img="https://images.unsplash.com/photo-1536440136628-849c177e76a1?w=200&h=280&fit=crop">
                                <div class="aspect-[3/4] rounded-lg overflow-hidden border-2 border-transparent hover:border-primary transition-all duration-200">
                                    <img src="https://images.unsplash.com/photo-1536440136628-849c177e76a1?w=200&h=280&fit=crop" alt="Cinematic" class="w-full h-full object-cover" />
                                </div>
                                <p class="text-xs text-center text-text-secondary mt-2 group-hover:text-text-primary">Cinematic</p>
                            </div>
                            <div class="style-option cursor-pointer group" data-style="business" data-name="Business" data-img="https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=200&h=280&fit=crop&crop=face">
                                <div class="aspect-[3/4] rounded-lg overflow-hidden border-2 border-transparent hover:border-primary transition-all duration-200">
                                    <img src="https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=200&h=280&fit=crop&crop=face" alt="Business" class="w-full h-full object-cover" />
                                </div>
                                <p class="text-xs text-center text-text-secondary mt-2 group-hover:text-text-primary">Business</p>
                            </div>
                            <div class="style-option cursor-pointer group" data-style="fashion" data-name="Fashion" data-img="https://images.unsplash.com/photo-1517841905240-472988babdf9?w=200&h=280&fit=crop&crop=face">
                                <div class="aspect-[3/4] rounded-lg overflow-hidden border-2 border-transparent hover:border-primary transition-all duration-200">
                                    <img src="https://images.unsplash.com/photo-1517841905240-472988babdf9?w=200&h=280&fit=crop&crop=face" alt="Fashion" class="w-full h-full object-cover" />
                                </div>
                                <p class="text-xs text-center text-text-secondary mt-2 group-hover:text-text-primary">Fashion</p>
                            </div>
                            <div class="style-option cursor-pointer group" data-style="moody" data-name="Moody" data-img="https://images.unsplash.com/photo-1494790108377-be9c29b29330?w=200&h=280&fit=crop&crop=face">
                                <div class="aspect-[3/4] rounded-lg overflow-hidden border-2 border-transparent hover:border-primary transition-all duration-200">
                                    <img src="https://images.unsplash.com/photo-1494790108377-be9c29b29330?w=200&h=280&fit=crop&crop=face" alt="Moody" class="w-full h-full object-cover" />
                                </div>
                                <p class="text-xs text-center text-text-secondary mt-2 group-hover:text-text-primary">Moody</p>
                            </div>
                            <div class="style-option cursor-pointer group" data-style="vintage" data-name="Vintage" data-img="https://images.unsplash.com/photo-1524504388940-b1c1722653e1?w=200&h=280&fit=crop&crop=face">
                                <div class="aspect-[3/4] rounded-lg overflow-hidden border-2 border-transparent hover:border-primary transition-all duration-200">
                                    <img src="https://images.unsplash.com/photo-1524504388940-b1c1722653e1?w=200&h=280&fit=crop&crop=face" alt="Vintage" class="w-full h-full object-cover" />
                                </div>
                                <p class="text-xs text-center text-text-secondary mt-2 group-hover:text-text-primary">Vintage</p>
                            </div>
                            <div class="style-option cursor-pointer group" data-style="portrait" data-name="Portrait" data-img="https://images.unsplash.com/photo-1531746020798-e6953c6e8e04?w=200&h=280&fit=crop&crop=face">
                                <div class="aspect-[3/4] rounded-lg overflow-hidden border-2 border-transparent hover:border-primary transition-all duration-200">
                                    <img src="https://images.unsplash.com/photo-1531746020798-e6953c6e8e04?w=200&h=280&fit=crop&crop=face" alt="Portrait" class="w-full h-full object-cover" />
                                </div>
                                <p class="text-xs text-center text-text-secondary mt-2 group-hover:text-text-primary">Portrait</p>
                            </div>
                            <div class="style-option cursor-pointer group" data-style="natural" data-name="Natural" data-img="https://images.unsplash.com/photo-1488426862026-3ee34a7d66df?w=200&h=280&fit=crop&crop=face">
                                <div class="aspect-[3/4] rounded-lg overflow-hidden border-2 border-transparent hover:border-primary transition-all duration-200">
                                    <img src="https://images.unsplash.com/photo-1488426862026-3ee34a7d66df?w=200&h=280&fit=crop&crop=face" alt="Natural" class="w-full h-full object-cover" />
                                </div>
                                <p class="text-xs text-center text-text-secondary mt-2 group-hover:text-text-primary">Natural</p>
                            </div>
                            <div class="style-option cursor-pointer group" data-style="urban" data-name="Urban" data-img="https://images.unsplash.com/photo-1539571696357-5a69c17a67c6?w=200&h=280&fit=crop&crop=face">
                                <div class="aspect-[3/4] rounded-lg overflow-hidden border-2 border-transparent hover:border-primary transition-all duration-200">
                                    <img src="https://images.unsplash.com/photo-1539571696357-5a69c17a67c6?w=200&h=280&fit=crop&crop=face" alt="Urban" class="w-full h-full object-cover" />
                                </div>
                                <p class="text-xs text-center text-text-secondary mt-2 group-hover:text-text-primary">Urban</p>
                            </div>
                            <div class="style-option cursor-pointer group" data-style="golden" data-name="Golden Hour" data-img="https://images.unsplash.com/photo-1509967419530-da38b4704bc6?w=200&h=280&fit=crop&crop=face">
                                <div class="aspect-[3/4] rounded-lg overflow-hidden border-2 border-transparent hover:border-primary transition-all duration-200">
                                    <img src="https://images.unsplash.com/photo-1509967419530-da38b4704bc6?w=200&h=280&fit=crop&crop=face" alt="Golden Hour" class="w-full h-full object-cover" />
                                </div>
                                <p class="text-xs text-center text-text-secondary mt-2 group-hover:text-text-primary">Golden Hour</p>
                            </div>
                            <div class="style-option cursor-pointer group" data-style="dramatic" data-name="Dramatic" data-img="https://images.unsplash.com/photo-1544005313-94ddf0286df2?w=200&h=280&fit=crop&crop=face">
                                <div class="aspect-[3/4] rounded-lg overflow-hidden border-2 border-transparent hover:border-primary transition-all duration-200">
                                    <img src="https://images.unsplash.com/photo-1544005313-94ddf0286df2?w=200&h=280&fit=crop&crop=face" alt="Dramatic" class="w-full h-full object-cover" />
                                </div>
                                <p class="text-xs text-center text-text-secondary mt-2 group-hover:text-text-primary">Dramatic</p>
                            </div>
                            <div class="style-option cursor-pointer group" data-style="lifestyle" data-name="Lifestyle" data-img="https://images.unsplash.com/photo-1504703395950-b89145a5425b?w=200&h=280&fit=crop&crop=face">
                                <div class="aspect-[3/4] rounded-lg overflow-hidden border-2 border-transparent hover:border-primary transition-all duration-200">
                                    <img src="https://images.unsplash.com/photo-1504703395950-b89145a5425b?w=200&h=280&fit=crop&crop=face" alt="Lifestyle" class="w-full h-full object-cover" />
                                </div>
                                <p class="text-xs text-center text-text-secondary mt-2 group-hover:text-text-primary">Lifestyle</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        
        <!-- Model Selection Panel - Compact Side Panel -->
        <div id="modelPanel" class="fixed top-[100px] h-[520px] w-[550px] bg-surface border border-border rounded-xl shadow-2xl z-40 transform translate-x-full opacity-0 transition-all duration-300 ease-out hidden" style="right: 400px;">
            <div class="h-full flex rounded-xl overflow-hidden">
                <!-- Left Sidebar - Model Categories -->
                <div class="w-32 bg-background border-r border-border flex flex-col flex-shrink-0">
                    <!-- Panel Header -->
                    <div class="p-3 border-b border-border">
                        <div class="flex items-center space-x-2">
                            <i class="fas fa-camera text-primary text-sm"></i>
                            <span class="text-sm font-semibold text-text-primary">Model</span>
                        </div>
                    </div>

                    <!-- Model Categories -->
                    <div class="flex-1 py-2">
                        <button type="button" class="model-category-btn w-full flex items-center space-x-2 px-3 py-2.5 text-left hover:bg-surface-elevated transition-colors duration-200 active" data-category="flux">
                            <span class="text-base">▲</span>
                            <span class="text-sm font-medium text-text-primary">Flux</span>
                        </button>
                        <button type="button" class="model-category-btn w-full flex items-center space-x-2 px-3 py-2.5 text-left hover:bg-surface-elevated transition-colors duration-200" data-category="google">
                            <span class="text-base">G</span>
                            <span class="text-sm font-medium text-text-primary">Google</span>
                        </button>
                        <button type="button" class="model-category-btn w-full flex items-center space-x-2 px-3 py-2.5 text-left hover:bg-surface-elevated transition-colors duration-200" data-category="magic">
                            <span class="text-base">✦</span>
                            <span class="text-sm font-medium text-text-primary">Magic</span>
                        </button>
                        <button type="button" class="model-category-btn w-full flex items-center space-x-2 px-3 py-2.5 text-left hover:bg-surface-elevated transition-colors duration-200" data-category="pro">
                            <span class="text-base">⊞</span>
                            <span class="text-sm font-medium text-text-primary">Pro</span>
                        </button>
                    </div>
                </div>

                <!-- Right Content - Model Options (SCROLL BURADA) -->
                <div class="flex-1 overflow-y-auto custom-scrollbar bg-surface">
                    <!-- Flux Models Content -->
                    <div id="flux-content" class="model-content p-4">
                        <div class="mb-4">
                            <h3 class="text-sm font-semibold text-text-primary mb-1">Cutting edge model for amazing images</h3>
                            <div class="flex flex-col text-xs text-text-secondary">
                                <span>1 Flux Image - 5 credits</span>
                            </div>
                        </div>

                        <div class="grid grid-cols-3 gap-3">
                            <!-- Black & White -->
                            <div class="model-option cursor-pointer group"
                                 data-base-model="flux"
                                 data-name="Black & White"
                                 data-img="https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=100&h=100&fit=crop&crop=face">
                                <div class="aspect-[3/4] rounded-lg overflow-hidden border-2 border-transparent hover:border-primary transition-all duration-200">
                                    <img src="https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=150&h=200&fit=crop&crop=face"
                                         alt="Black & White"
                                         class="w-full h-full object-cover grayscale" />
                                </div>
                                <p class="text-xs text-center text-text-secondary mt-1.5 group-hover:text-text-primary">Black & White</p>
                            </div>

                            <!-- Candid Portrait -->
                            <div class="model-option cursor-pointer group"
                                 data-base-model="flux"
                                 data-name="Candid Portrait"
                                 data-img="https://images.unsplash.com/photo-1494790108377-be9c29b29330?w=100&h=100&fit=crop&crop=face">
                                <div class="aspect-[3/4] rounded-lg overflow-hidden border-2 border-transparent hover:border-primary transition-all duration-200">
                                    <img src="https://images.unsplash.com/photo-1494790108377-be9c29b29330?w=150&h=200&fit=crop&crop=face"
                                         alt="Candid Portrait"
                                         class="w-full h-full object-cover" />
                                </div>
                                <p class="text-xs text-center text-text-secondary mt-1.5 group-hover:text-text-primary">Candid Portrait</p>
                            </div>

                            <!-- Cinematic -->
                            <div class="model-option cursor-pointer group"
                                 data-base-model="flux"
                                 data-name="Cinematic"
                                 data-img="https://images.unsplash.com/photo-1536440136628-849c177e76a1?w=100&h=100&fit=crop">
                                <div class="aspect-[3/4] rounded-lg overflow-hidden border-2 border-transparent hover:border-primary transition-all duration-200">
                                    <img src="https://images.unsplash.com/photo-1536440136628-849c177e76a1?w=150&h=200&fit=crop"
                                         alt="Cinematic"
                                         class="w-full h-full object-cover" />
                                </div>
                                <p class="text-xs text-center text-text-secondary mt-1.5 group-hover:text-text-primary">Cinematic</p>
                            </div>

                            <!-- Fashion -->
                            <div class="model-option cursor-pointer group"
                                 data-base-model="flux"
                                 data-name="Fashion"
                                 data-img="https://images.unsplash.com/photo-1509631179647-0177331693ae?w=100&h=100&fit=crop&crop=face">
                                <div class="aspect-[3/4] rounded-lg overflow-hidden border-2 border-transparent hover:border-primary transition-all duration-200">
                                    <img src="https://images.unsplash.com/photo-1509631179647-0177331693ae?w=150&h=200&fit=crop&crop=face"
                                         alt="Fashion"
                                         class="w-full h-full object-cover" />
                                </div>
                                <p class="text-xs text-center text-text-secondary mt-1.5 group-hover:text-text-primary">Fashion</p>
                            </div>

                            <!-- Fine Art -->
                            <div class="model-option cursor-pointer group"
                                 data-base-model="flux"
                                 data-name="Fine Art"
                                 data-img="https://images.unsplash.com/photo-1579783902614-a3fb3927b6a5?w=100&h=100&fit=crop">
                                <div class="aspect-[3/4] rounded-lg overflow-hidden border-2 border-transparent hover:border-primary transition-all duration-200">
                                    <img src="https://images.unsplash.com/photo-1579783902614-a3fb3927b6a5?w=150&h=200&fit=crop"
                                         alt="Fine Art"
                                         class="w-full h-full object-cover" />
                                </div>
                                <p class="text-xs text-center text-text-secondary mt-1.5 group-hover:text-text-primary">Fine Art</p>
                            </div>

                            <!-- Flux Photo -->
                            <div class="model-option cursor-pointer group"
                                 data-base-model="flux"
                                 data-name="Flux Photo"
                                 data-img="https://images.unsplash.com/photo-1531746020798-e6953c6e8e04?w=100&h=100&fit=crop&crop=face">
                                <div class="aspect-[3/4] rounded-lg overflow-hidden border-2 border-transparent hover:border-primary transition-all duration-200">
                                    <img src="https://images.unsplash.com/photo-1531746020798-e6953c6e8e04?w=150&h=200&fit=crop&crop=face"
                                         alt="Flux Photo"
                                         class="w-full h-full object-cover" />
                                </div>
                                <p class="text-xs text-center text-text-secondary mt-1.5 group-hover:text-text-primary">Flux Photo</p>
                            </div>

                            <!-- Flux TrueTouch -->
                            <div class="model-option cursor-pointer group"
                                 data-base-model="flux"
                                 data-name="Flux TrueTouch"
                                 data-img="https://images.unsplash.com/photo-1544005313-94ddf0286df2?w=100&h=100&fit=crop&crop=face">
                                <div class="aspect-[3/4] rounded-lg overflow-hidden border-2 border-transparent hover:border-primary transition-all duration-200 relative">
                                    <img src="https://images.unsplash.com/photo-1544005313-94ddf0286df2?w=150&h=200&fit=crop&crop=face"
                                         alt="Flux TrueTouch"
                                         class="w-full h-full object-cover" />
                                    <span class="absolute top-1 right-1 bg-green-500 text-white text-[10px] px-1.5 py-0.5 rounded">New</span>
                                </div>
                                <p class="text-xs text-center text-text-secondary mt-1.5 group-hover:text-text-primary">Flux TrueTouch</p>
                            </div>

                            <!-- Gothic -->
                            <div class="model-option cursor-pointer group"
                                 data-base-model="flux"
                                 data-name="Gothic"
                                 data-img="https://images.unsplash.com/photo-1509248961406-689dbc7e2b0f?w=100&h=100&fit=crop">
                                <div class="aspect-[3/4] rounded-lg overflow-hidden border-2 border-transparent hover:border-primary transition-all duration-200">
                                    <img src="https://images.unsplash.com/photo-1509248961406-689dbc7e2b0f?w=150&h=200&fit=crop"
                                         alt="Gothic"
                                         class="w-full h-full object-cover" />
                                </div>
                                <p class="text-xs text-center text-text-secondary mt-1.5 group-hover:text-text-primary">Gothic</p>
                            </div>

                            <!-- Horror -->
                            <div class="model-option cursor-pointer group"
                                 data-base-model="flux"
                                 data-name="Horror"
                                 data-img="https://images.unsplash.com/photo-1604975701397-6365ccbd028a?w=100&h=100&fit=crop">
                                <div class="aspect-[3/4] rounded-lg overflow-hidden border-2 border-transparent hover:border-primary transition-all duration-200">
                                    <img src="https://images.unsplash.com/photo-1604975701397-6365ccbd028a?w=150&h=200&fit=crop"
                                         alt="Horror"
                                         class="w-full h-full object-cover" />
                                </div>
                                <p class="text-xs text-center text-text-secondary mt-1.5 group-hover:text-text-primary">Horror</p>
                            </div>

                            <!-- Indie Film -->
                            <div class="model-option cursor-pointer group"
                                 data-base-model="flux"
                                 data-name="Indie Film"
                                 data-img="https://images.unsplash.com/photo-1485846234645-a62644f84728?w=100&h=100&fit=crop">
                                <div class="aspect-[3/4] rounded-lg overflow-hidden border-2 border-transparent hover:border-primary transition-all duration-200">
                                    <img src="https://images.unsplash.com/photo-1485846234645-a62644f84728?w=150&h=200&fit=crop"
                                         alt="Indie Film"
                                         class="w-full h-full object-cover" />
                                </div>
                                <p class="text-xs text-center text-text-secondary mt-1.5 group-hover:text-text-primary">Indie Film</p>
                            </div>
                        </div>
                    </div>

                    <!-- Google Models Content -->
                    <div id="google-content" class="model-content p-4 hidden">
                        <div class="mb-4">
                            <h3 class="text-sm font-semibold text-text-primary mb-1">Google's powerful image generation</h3>
                            <div class="text-xs text-text-secondary">
                                <span>1 Image - 8 credits</span>
                            </div>
                        </div>

                        <div class="grid grid-cols-3 gap-3">
                            <div class="model-option cursor-pointer group" data-model="google-imagen" data-name="Imagen" data-img="https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=100&h=100&fit=crop&crop=face">
                                <div class="aspect-[3/4] rounded-lg overflow-hidden border-2 border-transparent hover:border-primary transition-all duration-200">
                                    <img src="https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=150&h=200&fit=crop&crop=face" alt="Imagen" class="w-full h-full object-cover" />
                                </div>
                                <p class="text-xs text-center text-text-secondary mt-1.5 group-hover:text-text-primary">Imagen</p>
                            </div>
                            <div class="model-option cursor-pointer group" data-model="google-gemini" data-name="Gemini" data-img="https://images.unsplash.com/photo-1539571696357-5a69c17a67c6?w=100&h=100&fit=crop&crop=face">
                                <div class="aspect-[3/4] rounded-lg overflow-hidden border-2 border-transparent hover:border-primary transition-all duration-200">
                                    <img src="https://images.unsplash.com/photo-1539571696357-5a69c17a67c6?w=150&h=200&fit=crop&crop=face" alt="Gemini" class="w-full h-full object-cover" />
                                </div>
                                <p class="text-xs text-center text-text-secondary mt-1.5 group-hover:text-text-primary">Gemini</p>
                            </div>
                            <div class="model-option cursor-pointer group" data-model="google-photo" data-name="Photorealistic" data-img="https://images.unsplash.com/photo-1488426862026-3ee34a7d66df?w=100&h=100&fit=crop&crop=face">
                                <div class="aspect-[3/4] rounded-lg overflow-hidden border-2 border-transparent hover:border-primary transition-all duration-200">
                                    <img src="https://images.unsplash.com/photo-1488426862026-3ee34a7d66df?w=150&h=200&fit=crop&crop=face" alt="Photorealistic" class="w-full h-full object-cover" />
                                </div>
                                <p class="text-xs text-center text-text-secondary mt-1.5 group-hover:text-text-primary">Photorealistic</p>
                            </div>
                        </div>
                    </div>

                    <!-- Magic Models Content -->
                    <div id="magic-content" class="model-content p-4 hidden">
                        <div class="mb-4">
                            <h3 class="text-sm font-semibold text-text-primary mb-1">Magical and artistic styles</h3>
                            <div class="text-xs text-text-secondary">
                                <span>1 Image - 6 credits</span>
                            </div>
                        </div>

                        <div class="grid grid-cols-3 gap-3">
                            <div class="model-option cursor-pointer group" data-model="magic-fantasy" data-name="Fantasy" data-img="https://images.unsplash.com/photo-1518882605630-8b57d60260e3?w=100&h=100&fit=crop">
                                <div class="aspect-[3/4] rounded-lg overflow-hidden border-2 border-transparent hover:border-primary transition-all duration-200">
                                    <img src="https://images.unsplash.com/photo-1518882605630-8b57d60260e3?w=150&h=200&fit=crop" alt="Fantasy" class="w-full h-full object-cover" />
                                </div>
                                <p class="text-xs text-center text-text-secondary mt-1.5 group-hover:text-text-primary">Fantasy</p>
                            </div>
                            <div class="model-option cursor-pointer group" data-model="magic-anime" data-name="Anime" data-img="https://images.unsplash.com/photo-1578632767115-351597cf2477?w=100&h=100&fit=crop">
                                <div class="aspect-[3/4] rounded-lg overflow-hidden border-2 border-transparent hover:border-primary transition-all duration-200">
                                    <img src="https://images.unsplash.com/photo-1578632767115-351597cf2477?w=150&h=200&fit=crop" alt="Anime" class="w-full h-full object-cover" />
                                </div>
                                <p class="text-xs text-center text-text-secondary mt-1.5 group-hover:text-text-primary">Anime</p>
                            </div>
                            <div class="model-option cursor-pointer group" data-model="magic-neon" data-name="Neon Noir" data-img="https://images.unsplash.com/photo-1633177317976-3f9bc45e1d1d?w=100&h=100&fit=crop">
                                <div class="aspect-[3/4] rounded-lg overflow-hidden border-2 border-transparent hover:border-primary transition-all duration-200">
                                    <img src="https://images.unsplash.com/photo-1633177317976-3f9bc45e1d1d?w=150&h=200&fit=crop" alt="Neon Noir" class="w-full h-full object-cover" />
                                </div>
                                <p class="text-xs text-center text-text-secondary mt-1.5 group-hover:text-text-primary">Neon Noir</p>
                            </div>
                        </div>
                    </div>

                    <!-- Pro Models Content -->
                    <div id="pro-content" class="model-content p-4 hidden">
                        <div class="mb-4">
                            <h3 class="text-sm font-semibold text-text-primary mb-1">Professional grade models</h3>
                            <div class="flex flex-col text-xs text-text-secondary">
                                <span>1 Image - 15 credits</span>
                                <span>Commercial license included</span>
                            </div>
                        </div>

                        <div class="grid grid-cols-3 gap-3">
                            <div class="model-option cursor-pointer group" data-model="pro-studio" data-name="Studio" data-img="https://images.unsplash.com/photo-1544005313-94ddf0286df2?w=100&h=100&fit=crop&crop=face">
                                <div class="aspect-[3/4] rounded-lg overflow-hidden border-2 border-transparent hover:border-primary transition-all duration-200">
                                    <img src="https://images.unsplash.com/photo-1544005313-94ddf0286df2?w=150&h=200&fit=crop&crop=face" alt="Studio" class="w-full h-full object-cover" />
                                </div>
                                <p class="text-xs text-center text-text-secondary mt-1.5 group-hover:text-text-primary">Studio</p>
                            </div>
                            <div class="model-option cursor-pointer group" data-model="pro-product" data-name="Product" data-img="https://images.unsplash.com/photo-1523275335684-37898b6baf30?w=100&h=100&fit=crop">
                                <div class="aspect-[3/4] rounded-lg overflow-hidden border-2 border-transparent hover:border-primary transition-all duration-200">
                                    <img src="https://images.unsplash.com/photo-1523275335684-37898b6baf30?w=150&h=200&fit=crop" alt="Product" class="w-full h-full object-cover" />
                                </div>
                                <p class="text-xs text-center text-text-secondary mt-1.5 group-hover:text-text-primary">Product</p>
                            </div>
                            <div class="model-option cursor-pointer group" data-model="pro-night" data-name="Night" data-img="https://images.unsplash.com/photo-1560250097-0b93528c311a?w=100&h=100&fit=crop&crop=face">
                                <div class="aspect-[3/4] rounded-lg overflow-hidden border-2 border-transparent hover:border-primary transition-all duration-200">
                                    <img src="https://images.unsplash.com/photo-1560250097-0b93528c311a?w=150&h=200&fit=crop&crop=face" alt="Night" class="w-full h-full object-cover" />
                                </div>
                                <p class="text-xs text-center text-text-secondary mt-1.5 group-hover:text-text-primary">Night</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- Model selection slidebar end -->


        <!-- Right Sidebar -->
        <div class="w-96 bg-surface border-l border-border h-screen overflow-y-auto custom-scrollbar order-3 flex-shrink-0 transition-all duration-300 ease-out" id="rightSidebar">

            <form asp-controller="RenderNet" asp-action="GenerateImage" id="uploadForm" method="post" enctype="multipart/form-data" class="p-6 space-y-6">
                <div class="p-6 space-y-6">
                    <!-- Consistency Controls -->
                    <div class="space-y-3 mb-6">
                        <label class="block text-sm font-medium text-text-primary">Consistency Controls</label>
                        <div class="flex space-x-3">
                            <button type="button" id="characterBtn" class="flex-1 bg-surface-elevated hover:bg-primary/10 border border-border hover:border-primary rounded-lg p-4 text-center transition-all duration-200 group">
                                <div class="flex flex-col items-center space-y-2">
                                    <i class="fas fa-user text-xl text-text-secondary group-hover:text-primary"></i>
                                    <span class="text-sm text-text-secondary group-hover:text-primary">Character</span>
                                </div>
                            </button>
                            <button type="button" id="faceLockBtn" name="AssetFile" class="flex-1 bg-surface-elevated hover:bg-primary/10 border border-border hover:border-primary rounded-lg p-4 text-center transition-all duration-200 group">
                                <div class="flex flex-col items-center space-y-2">
                                    <i class="fas fa-user-lock text-xl text-text-secondary group-hover:text-primary"></i>
                                    <span class="text-sm text-text-secondary group-hover:text-primary">Face Lock</span>
                                </div>
                            </button>
                            <button type="button" id="poseLockBtn" class="flex-1 bg-surface-elevated hover:bg-primary/10 border border-border hover:border-primary rounded-lg p-4 text-center transition-all duration-200 group">
                                <div class="flex flex-col items-center space-y-2">
                                    <i class="fas fa-running text-xl text-text-secondary group-hover:text-primary"></i>
                                    <span class="text-sm text-text-secondary group-hover:text-primary">Pose Lock</span>
                                </div>
                            </button>
                        </div>
                    </div>

                    <!-- Face Lock Drop Zone (Hidden by default) -->
                    <div id="faceLockDropZone" class="hidden space-y-3 mb-6">
                        <div class="border-2 border-dashed border-border rounded-lg p-6 text-center hover:border-primary/50 transition-colors duration-200 cursor-pointer" id="faceLockUploadArea">
                            <input type="file" id="faceLockImage" name="AssetFile" accept="image/*" class="hidden" />
                            <div id="faceLockUploadContent">
                                <i class="fas fa-cloud-upload-alt text-2xl text-text-secondary mb-2"></i>
                                <p class="text-sm text-text-secondary mb-1">Drop face image here or click to browse</p>
                                <p class="text-xs text-text-muted">PNG, JPG up to 10MB</p>
                            </div>
                            <div id="faceLockImagePreview" class="hidden">
                                <img id="faceLockPreviewImg" src alt="Face Lock Preview" class="max-w-full h-32 object-cover rounded-lg mx-auto" />
                                <button type="button" id="removeFaceLockImage" class="mt-2 text-xs text-error hover:text-error-600 transition-colors duration-200">
                                    <i class="fas fa-times mr-1"></i>Remove
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Prompt Section -->
                    <div class="space-y-3">
                        <label class="block text-sm font-medium text-text-primary">Image Prompt</label>
                        <div class="relative">
                            <textarea id="promptInput" name="PositivePrompt" placeholder="Describe the image you want to create... Be as detailed as possible for better results. Example: A majestic dragon soaring through a sunset sky with golden clouds, fantasy art style, highly detailed, 4K resolution" class="w-full h-32 bg-background border border-border rounded-lg px-4 py-3 pr-12 text-text-primary placeholder-text-muted resize-none focus:border-primary focus:ring-2 focus:ring-primary/20 focus:outline-none transition-all duration-200"></textarea>
                            <button type="button" id="randomPromptBtn" class="absolute bottom-3 right-3 w-8 h-8 bg-surface-elevated hover:bg-primary/10 border border-border hover:border-primary rounded-lg flex items-center justify-center transition-all duration-200 group" title="Get random prompt">
                                <i class="fas fa-dice text-text-secondary group-hover:text-primary text-sm"></i>
                            </button>
                        </div>
                        <div class="flex justify-between items-center text-xs text-text-muted">
                            <span>Be descriptive for better results</span>
                            <span id="charCount">0/500</span>
                        </div>
                    </div>

                    <!-- Generate Button -->
                    <button type="submit" id="generateBtn" class="w-full bg-gradient-to-r from-primary to-secondary hover:from-primary-600 hover:to-secondary-600 text-white font-medium py-3 px-6 rounded-lg transition-all duration-200 shadow-floating hover:shadow-lg transform hover:-translate-y-0.5 disabled:opacity-50 disabled:cursor-not-allowed disabled:transform-none">
                        <i class="fas fa-magic mr-2"></i>
                        Generate Image
                    </button>

                    <!-- Model Selection -->
                    <!-- Model Selection - Expandable Panel Trigger -->
                    <div class="space-y-3">
                        <input type="hidden" id="selectedModelValue" name="Model" value="" />
                        <input type="hidden" id="selectedModelBaseModel" name="StyleDetail.BaseModel" value="" />
                        <input type="hidden" id="selectedModelName" name="StyleDetail.Name" value="" />
                        <button type="button" id="modelSelectBtn" class="w-full flex items-center justify-between bg-surface-elevated hover:bg-surface-hover border border-border hover:border-primary rounded-lg p-4 text-left transition-all duration-200 group">
                            <div class="flex items-center space-x-3">
                                <i class="fas fa-camera text-text-secondary group-hover:text-primary"></i>
                                <div>
                                    <h3 class="text-sm font-medium text-text-primary">Model</h3>
                                    <p id="selectedModelText" class="text-xs text-text-secondary">Select a model to start generating images</p>
                                </div>
                            </div>
                            <i id="modelArrow" class="fas fa-chevron-right text-text-secondary group-hover:text-primary transition-transform duration-200"></i>
                        </button>

                        <!-- Selected Models Tags Container -->
                        <div id="selectedModelsContainer" class="hidden mt-3">
                            <div id="selectedModelsTags" class="flex flex-wrap gap-1.5 max-w-full">
                                <!-- Tags will be added here dynamically -->
                            </div>
                            <button type="button" id="clearAllModelsBtn" class="text-xs text-text-muted hover:text-error mt-2 transition-colors duration-200">
                                Clear all
                            </button>
                        </div>
                    </div>

                    <!-- Flux Image Style Section -->
                    <div class="space-y-3" id="fluxImageStyleSection">
                        <!-- Flux Image Style - DTO Binding -->
                        <input type="hidden" id="selectedStyleValue" name="StyleReference" value="" />

                        <!-- Seçim Yapılmadan Önceki Görünüm -->
                        <div id="fluxStyleDefault" class="block">
                            <button type="button" id="fluxImageStyleBtn" class="w-full flex items-center justify-between bg-surface-elevated hover:bg-surface-hover border border-border hover:border-primary rounded-lg p-4 text-left transition-all duration-200 group">
                                <div class="flex items-center space-x-3">
                                    <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="text-text-secondary group-hover:text-primary">
                                        <path d="M10 5.5C10 5.30222 10.0586 5.10888 10.1685 4.94443C10.2784 4.77998 10.4346 4.65181 10.6173 4.57612C10.8 4.50043 11.0011 4.48063 11.1951 4.51921C11.3891 4.5578 11.5673 4.65304 11.7071 4.79289C11.847 4.93275 11.9422 5.11093 11.9808 5.30491C12.0194 5.49889 11.9996 5.69996 11.9239 5.88268C11.8482 6.06541 11.72 6.22159 11.5556 6.33147C11.3911 6.44135 11.1978 6.5 11 6.5C10.7348 6.5 10.4804 6.39464 10.2929 6.20711C10.1054 6.01957 10 5.76522 10 5.5ZM14.75 3.5V10C14.75 10.3315 14.6183 10.6495 14.3839 10.8839C14.1495 11.1183 13.8315 11.25 13.5 11.25H12.75V12.5C12.75 12.8315 12.6183 13.1495 12.3839 13.3839C12.1495 13.6183 11.8315 13.75 11.5 13.75H2.5C2.16848 13.75 1.85054 13.6183 1.61612 13.3839C1.3817 13.1495 1.25 12.8315 1.25 12.5V5.5C1.25 5.16848 1.3817 4.85054 1.61612 4.61612C1.85054 4.3817 2.16848 4.25 2.5 4.25H3.75V3.5C3.75 3.16848 3.8817 2.85054 4.11612 2.61612C4.35054 2.3817 4.66848 2.25 5 2.25H13.5C13.8315 2.25 14.1495 2.3817 14.3839 2.61612C14.6183 2.85054 14.75 3.16848 14.75 3.5ZM11.25 11.25H5C4.66848 11.25 4.35054 11.1183 4.11612 10.8839C3.8817 10.6495 3.75 10.3315 3.75 10V5.75H2.75V12.25H11.25V11.25ZM9.89625 9.75L7.75 7.60375L5.60375 9.75H9.89625ZM13.25 3.75H5.25V7.9825L6.86625 6.36625C7.10066 6.13191 7.41854 6.00027 7.75 6.00027C8.08146 6.00027 8.39934 6.13191 8.63375 6.36625L12.0175 9.75H13.25V3.75Z" fill="currentColor" />
                                    </svg>
                                    <div>
                                        <h3 class="text-sm font-medium text-text-primary">Flux Image Style</h3>
                                        <p class="text-xs text-text-secondary">Upload a reference pic to generate images in a similar style</p>
                                    </div>
                                </div>
                                <div class="w-6 h-6 bg-background border border-border rounded flex items-center justify-center">
                                    <i id="fluxStyleArrow" class="fas fa-chevron-right text-text-secondary text-xs transition-transform duration-200"></i>
                                </div>
                            </button>
                        </div>

                        <!-- Seçim Yapıldıktan Sonraki Görünüm (Affogato tarzı) -->
                        <div id="fluxStyleSelected" class="hidden">
                            <!-- Header - Tıklanabilir -->
                            <button type="button" id="fluxStyleSelectedBtn" class="w-full flex items-center justify-between bg-surface-elevated border border-border rounded-t-lg p-4 text-left transition-all duration-200 hover:bg-surface-hover group">
                                <div class="flex items-center space-x-3">
                                    <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="text-text-secondary">
                                        <path d="M10 5.5C10 5.30222 10.0586 5.10888 10.1685 4.94443C10.2784 4.77998 10.4346 4.65181 10.6173 4.57612C10.8 4.50043 11.0011 4.48063 11.1951 4.51921C11.3891 4.5578 11.5673 4.65304 11.7071 4.79289C11.847 4.93275 11.9422 5.11093 11.9808 5.30491C12.0194 5.49889 11.9996 5.69996 11.9239 5.88268C11.8482 6.06541 11.72 6.22159 11.5556 6.33147C11.3911 6.44135 11.1978 6.5 11 6.5C10.7348 6.5 10.4804 6.39464 10.2929 6.20711C10.1054 6.01957 10 5.76522 10 5.5ZM14.75 3.5V10C14.75 10.3315 14.6183 10.6495 14.3839 10.8839C14.1495 11.1183 13.8315 11.25 13.5 11.25H12.75V12.5C12.75 12.8315 12.6183 13.1495 12.3839 13.3839C12.1495 13.6183 11.8315 13.75 11.5 13.75H2.5C2.16848 13.75 1.85054 13.6183 1.61612 13.3839C1.3817 13.1495 1.25 12.8315 1.25 12.5V5.5C1.25 5.16848 1.3817 4.85054 1.61612 4.61612C1.85054 4.3817 2.16848 4.25 2.5 4.25H3.75V3.5C3.75 3.16848 3.8817 2.85054 4.11612 2.61612C4.35054 2.3817 4.66848 2.25 5 2.25H13.5C13.8315 2.25 14.1495 2.3817 14.3839 2.61612C14.6183 2.85054 14.75 3.16848 14.75 3.5ZM11.25 11.25H5C4.66848 11.25 4.35054 11.1183 4.11612 10.8839C3.8817 10.6495 3.75 10.3315 3.75 10V5.75H2.75V12.25H11.25V11.25ZM9.89625 9.75L7.75 7.60375L5.60375 9.75H9.89625ZM13.25 3.75H5.25V7.9825L6.86625 6.36625C7.10066 6.13191 7.41854 6.00027 7.75 6.00027C8.08146 6.00027 8.39934 6.13191 8.63375 6.36625L12.0175 9.75H13.25V3.75Z" fill="currentColor" />
                                    </svg>
                                    <p class="text-sm font-medium text-text-primary">Flux Image Style</p>
                                </div>
                                <div class="w-6 h-6 bg-background border border-border rounded flex items-center justify-center">
                                    <i id="fluxStyleArrowSelected" class="fas fa-chevron-right text-text-secondary text-xs transition-transform duration-200"></i>
                                </div>
                            </button>

                            <!-- Body - Seçilen Görsel ve Kontroller -->
                            <div class="bg-surface-elevated border border-t-0 border-border rounded-b-lg p-4">
                                <div class="flex items-start space-x-3">
                                    <!-- Seçilen Görsel -->
                                    <div class="relative flex-shrink-0">
                                        <img id="selectedStylePreview" src="" alt="Selected Style" class="w-16 h-16 object-cover rounded-lg cursor-pointer hover:opacity-80 transition-opacity" />
                                    </div>

                                    <!-- Açıklama ve Kontroller -->
                                    <div class="flex-1 min-w-0">
                                        <div class="flex items-center justify-between mb-3">
                                            <p class="text-xs text-text-secondary">Lower intensity allows more variation</p>
                                            <button type="button" id="removeSelectedStyle" class="w-7 h-7 flex items-center justify-center rounded hover:bg-error/10 transition-colors duration-200 group/delete">
                                                <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="text-text-muted group-hover/delete:text-error transition-colors">
                                                    <path d="M12.6667 7.33301V13.3997C12.6667 13.731 12.3981 13.9997 12.0667 13.9997H3.93337C3.602 13.9997 3.33337 13.731 3.33337 13.3997V7.33301" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" />
                                                    <path d="M6.66663 11.333V7.33301" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" />
                                                    <path d="M9.33337 11.333V7.33301" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" />
                                                    <path d="M14 4.66699L10.6667 4.66699M2 4.66699L5.33333 4.66699M5.33333 4.66699V2.60033C5.33333 2.26896 5.60196 2.00033 5.93333 2.00033H10.0667C10.398 2.00033 10.6667 2.26895 10.6667 2.60033V4.66699M5.33333 4.66699L10.6667 4.66699" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" />
                                                </svg>
                                            </button>
                                        </div>

                                        <!-- Intensity Slider -->
                                        <div class="flex items-center space-x-3">
                                            <span class="text-xs text-text-secondary whitespace-nowrap">Intensity</span>
                                            <div class="flex-1 relative">
                                                <input type="range" id="styleIntensity" name="StyleIntensity" min="1" max="10" value="1" class="w-full h-1 bg-surface rounded-full appearance-none cursor-pointer" />
                                            </div>
                                            <span id="intensityValue" class="text-xs text-text-primary w-4 text-center">1</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Aspect Ratio -->
                    <div class="space-y-3">
                        <label class="block text-sm font-medium text-text-primary">Aspect Ratio</label>
                        <select name="AspectRatio" class="w-full bg-background border border-border rounded-lg px-4 py-3 text-text-primary focus:border-primary focus:ring-2 focus:ring-primary/20 focus:outline-none transition-all duration-200">
                            <option value="4:5" selected>4:5 (Portrait)</option>
                            <option value="1:1">1:1 (Square)</option>
                            <option value="16:9">16:9 (Landscape)</option>
                            <option value="3:2">3:2 (Classic)</option>
                            <option value="9:16">9:16 (Mobile)</option>
                            <option value="2:3">2:3 (Tall Portrait)</option>
                        </select>
                    </div>

                    <!-- Image Count -->
                    <div class="space-y-3">
                        <label class="block text-sm font-medium text-text-primary">Number of Images</label>
                        <div class="flex items-center space-x-3">
                            <button type="button" id="decreaseCount" name="BatchSize" class="w-10 h-10 bg-background border border-border rounded-lg flex items-center justify-center hover:border-primary transition-colors duration-200">
                                <i class="fas fa-minus text-text-secondary"></i>
                            </button>
                            <input type="number" id="imageCount" name="BatchSize" value="1" min="1" max="4" class="flex-1 bg-background border border-border rounded-lg px-4 py-2 text-center text-text-primary focus:border-primary focus:ring-2 focus:ring-primary/20 focus:outline-none transition-all duration-200" />
                            <button type="button" id="increaseCount" class="w-10 h-10 bg-background border border-border rounded-lg flex items-center justify-center hover:border-primary transition-colors duration-200">
                                <i class="fas fa-plus text-text-secondary"></i>
                            </button>
                        </div>
                        <p class="text-xs text-text-muted">Generate 1-4 images at once</p>
                    </div>

                    <!-- Seed Configuration -->
                    <div class="space-y-3">
                        <label class="block text-sm font-medium text-text-primary">Seed</label>
                        <div class="flex space-x-2">
                            <select class="flex-1 bg-background border border-border rounded-lg px-4 py-3 text-text-primary focus:border-primary focus:ring-2 focus:ring-primary/20 focus:outline-none transition-all duration-200">
                                <option value="random" selected>Random</option>
                                <option value="custom">Custom Seed</option>
                            </select>
                            <button type="button" class="px-4 py-3 bg-background border border-border rounded-lg hover:border-primary transition-colors duration-200">
                                <i class="fas fa-dice text-text-secondary"></i>
                            </button>
                        </div>
                    </div>

                    <!-- Clear All Button -->
                    <button type="reset" id="clearAllBtn" class="w-full bg-surface-elevated hover:bg-error/10 border border-border hover:border-error text-text-secondary hover:text-error font-medium py-3 px-6 rounded-lg transition-all duration-200">
                        <i class="fas fa-trash-alt mr-2"></i>
                        Clear All
                    </button>
            </form>

          
        </div>
    </div>
    </div>

    <script>
        // Predefined random prompts array for client-side functionality
        const randomPrompts = [
            "A majestic dragon soaring through a sunset sky with golden clouds, fantasy art style, highly detailed, 4K resolution",
            "Cyberpunk cityscape at night with neon lights reflecting on wet streets, futuristic architecture, atmospheric lighting",
            "Enchanted forest with glowing mushrooms, fairy lights, magical atmosphere, digital art style, vibrant colors",
            "Ancient castle on a cliff overlooking a stormy ocean, dramatic lighting, gothic architecture, dark fantasy",
            "Space explorer walking on an alien planet with twin moons, sci-fi concept art, cinematic composition",
            "Steampunk airship flying above Victorian city, brass and copper details, industrial aesthetic, vintage technology",
            "Underwater palace made of coral and pearls, mermaids swimming nearby, bioluminescent sea life, ethereal lighting",
            "Post-apocalyptic wasteland with abandoned buildings, overgrown vegetation, dramatic sky, concept art style",
            "Japanese temple in cherry blossom season, traditional architecture, peaceful atmosphere, spring colors",
            "Robot warrior in futuristic armor, mechanical details, glowing energy weapons, dynamic action pose"
        ];

        // Character count for prompt
        const promptInput = document.getElementById('promptInput');
        const charCount = document.getElementById('charCount');

        promptInput.addEventListener('input', function() {
            const count = this.value.length;
            charCount.textContent = `${count}/500`;
            if (count > 500) {
                charCount.classList.add('text-error');
            } else {
                charCount.classList.remove('text-error');
            }
        });

        // Random Prompt functionality - Now using client-side array
        const randomPromptBtn = document.getElementById('randomPromptBtn');

        randomPromptBtn.addEventListener('click', function() {
            // Add loading state
            const originalHTML = this.innerHTML;
            this.innerHTML = '<i class="fas fa-spinner fa-spin text-text-secondary text-sm"></i>';
            this.disabled = true;

            // Simulate brief loading for better UX
            setTimeout(() => {
                try {
                    // Get random prompt from predefined array
                    const randomIndex = Math.floor(Math.random() * randomPrompts.length);
                    const randomPrompt = randomPrompts[randomIndex];

                    promptInput.value = randomPrompt;
                    // Trigger input event to update character count
                    promptInput.dispatchEvent(new Event('input'));

                    // Add visual feedback
                    promptInput.classList.add('border-primary');
                    setTimeout(() => {
                        promptInput.classList.remove('border-primary');
                    }, 1000);

                } catch (error) {
                    console.error('Error generating random prompt:', error);
                    // Show error feedback
                    this.classList.add('border-error');
                    setTimeout(() => {
                        this.classList.remove('border-error');
                    }, 1000);
                } finally {
                    // Restore button state
                    this.innerHTML = originalHTML;
                    this.disabled = false;
                }
            }, 500);
        });

        // Consistency Controls functionality
        const characterBtn = document.getElementById('characterBtn');
        const faceLockBtn = document.getElementById('faceLockBtn');
        const poseLockBtn = document.getElementById('poseLockBtn');
        const faceLockDropZone = document.getElementById('faceLockDropZone');

        // Face Lock button functionality
        faceLockBtn.addEventListener('click', function() {
            // Toggle active state
            faceLockBtn.classList.toggle('bg-primary');
            faceLockBtn.classList.toggle('text-white');

            // Toggle drop zone visibility
            if (faceLockDropZone.classList.contains('hidden')) {
                faceLockDropZone.classList.remove('hidden');
                faceLockBtn.querySelector('span').textContent = 'Face Lock Active';
            } else {
                faceLockDropZone.classList.add('hidden');
                faceLockBtn.querySelector('span').textContent = 'Face Lock';
                faceLockBtn.classList.remove('bg-primary', 'text-white');
            }
        });

        // Face Lock file upload handling
        const faceLockUploadArea = document.getElementById('faceLockUploadArea');
        const faceLockImage = document.getElementById('faceLockImage');
        const faceLockUploadContent = document.getElementById('faceLockUploadContent');
        const faceLockImagePreview = document.getElementById('faceLockImagePreview');
        const faceLockPreviewImg = document.getElementById('faceLockPreviewImg');
        const removeFaceLockImage = document.getElementById('removeFaceLockImage');

        faceLockUploadArea.addEventListener('click', () => faceLockImage.click());

        faceLockUploadArea.addEventListener('dragover', (e) => {
            e.preventDefault();
            faceLockUploadArea.classList.add('border-primary');
        });

        faceLockUploadArea.addEventListener('dragleave', () => {
            faceLockUploadArea.classList.remove('border-primary');
        });

        faceLockUploadArea.addEventListener('drop', (e) => {
            e.preventDefault();
            faceLockUploadArea.classList.remove('border-primary');
            const files = e.dataTransfer.files;
            if (files.length > 0) {
                handleFaceLockFileUpload(files[0]);
            }
        });

        faceLockImage.addEventListener('change', (e) => {
            if (e.target.files.length > 0) {
                handleFaceLockFileUpload(e.target.files[0]);
            }
        });

        function handleFaceLockFileUpload(file) {
            if (file.type.startsWith('image/')) {
                const reader = new FileReader();
                reader.onload = (e) => {
                    faceLockPreviewImg.src = e.target.result;
                    faceLockUploadContent.classList.add('hidden');
                    faceLockImagePreview.classList.remove('hidden');
                };
                reader.readAsDataURL(file);
            }
        }

        removeFaceLockImage.addEventListener('click', (e) => {
            e.stopPropagation();
            faceLockImage.value = '';
            faceLockUploadContent.classList.remove('hidden');
            faceLockImagePreview.classList.add('hidden');
        });

                // ================================================
        // FLUX IMAGE STYLE PANEL FUNCTIONALITY
        // ================================================

        const fluxImageStyleBtn = document.getElementById('fluxImageStyleBtn');
        const fluxStyleSelectedBtn = document.getElementById('fluxStyleSelectedBtn');
        const fluxStylePanel = document.getElementById('fluxStylePanel');
        const fluxStyleArrow = document.getElementById('fluxStyleArrow');
        const fluxStyleArrowSelected = document.getElementById('fluxStyleArrowSelected');
        const closeFluxPanelBtn = document.getElementById('closeFluxPanelBtn');
        const styleOptions = document.querySelectorAll('.style-option');
        const selectedStyleValue = document.getElementById('selectedStyleValue');
        const selectedStylePreview = document.getElementById('selectedStylePreview');
        const removeSelectedStyle = document.getElementById('removeSelectedStyle');
        const styleIntensity = document.getElementById('styleIntensity');
        const intensityValue = document.getElementById('intensityValue');
        const fluxStyleDefault = document.getElementById('fluxStyleDefault');
        const fluxStyleSelected = document.getElementById('fluxStyleSelected');

        // Upload elements
        const styleUploadArea = document.getElementById('styleUploadArea');
        const styleImageInput = document.getElementById('styleImageInput');
        const styleUploadContent = document.getElementById('styleUploadContent');
        const styleUploadPreview = document.getElementById('styleUploadPreview');
        const styleUploadPreviewImg = document.getElementById('styleUploadPreviewImg');
        const removeUploadedStyle = document.getElementById('removeUploadedStyle');

        let isFluxStylePanelOpen = false;
        let selectedStyle = null;

        function openFluxStylePanel() {
            if (isFluxStylePanelOpen) return;
            isFluxStylePanelOpen = true;

            fluxStylePanel.classList.remove('hidden');

            // Rotate arrow
            if (fluxStyleArrow) fluxStyleArrow.style.transform = 'rotate(180deg)';
            if (fluxStyleArrowSelected) fluxStyleArrowSelected.style.transform = 'rotate(180deg)';

            setTimeout(() => {
                fluxStylePanel.classList.add('open');
            }, 10);
        }

        function closeFluxStylePanel() {
            if (!isFluxStylePanelOpen) return;
            isFluxStylePanelOpen = false;

            fluxStylePanel.classList.remove('open');

            // Reset arrow
            if (fluxStyleArrow) fluxStyleArrow.style.transform = 'rotate(0deg)';
            if (fluxStyleArrowSelected) fluxStyleArrowSelected.style.transform = 'rotate(0deg)';

            setTimeout(() => {
                fluxStylePanel.classList.add('hidden');
            }, 300);
        }

        // Toggle panel - Default button
        if (fluxImageStyleBtn) {
            fluxImageStyleBtn.addEventListener('click', (e) => {
                e.preventDefault();
                if (isFluxStylePanelOpen) {
                    closeFluxStylePanel();
                } else {
                    openFluxStylePanel();
                }
            });
        }

        // Toggle panel - Selected state button
        if (fluxStyleSelectedBtn) {
            fluxStyleSelectedBtn.addEventListener('click', (e) => {
                e.preventDefault();
                if (isFluxStylePanelOpen) {
                    closeFluxStylePanel();
                } else {
                    openFluxStylePanel();
                }
            });
        }

        // Close button
        if (closeFluxPanelBtn) {
            closeFluxPanelBtn.addEventListener('click', closeFluxStylePanel);
        }

        function updateFluxStyleUI() {
            if (!selectedStyle) {
                // No selection - show default button
                if (fluxStyleDefault) fluxStyleDefault.classList.remove('hidden');
                if (fluxStyleSelected) fluxStyleSelected.classList.add('hidden');
                if (selectedStyleValue) selectedStyleValue.value = '';
                return;
            }

            // Has selection - show selected view
            if (fluxStyleDefault) fluxStyleDefault.classList.add('hidden');
            if (fluxStyleSelected) fluxStyleSelected.classList.remove('hidden');
            if (selectedStylePreview) selectedStylePreview.src = selectedStyle.img;
            if (selectedStyleValue) selectedStyleValue.value = selectedStyle.id;
        }

        // Style option selection
        styleOptions.forEach(option => {
            option.addEventListener('click', function() {
                const styleId = this.dataset.style;
                const styleName = this.dataset.name;
                const styleImg = this.dataset.img;

                // Remove previous selection
                styleOptions.forEach(opt => opt.classList.remove('selected'));

                // Add selection to clicked
                this.classList.add('selected');

                // Update selected style
                selectedStyle = {
                    id: styleId,
                    name: styleName,
                    img: styleImg,
                    isUploaded: false
                };

                updateFluxStyleUI();

                // Close panel after selection
                setTimeout(() => {
                    closeFluxStylePanel();
                }, 200);
            });
        });

        // Remove selected style
        if (removeSelectedStyle) {
            removeSelectedStyle.addEventListener('click', (e) => {
                e.stopPropagation();
                selectedStyle = null;
                styleOptions.forEach(opt => opt.classList.remove('selected'));
                updateFluxStyleUI();

                // Reset upload if it was uploaded
                if (styleUploadContent) styleUploadContent.classList.remove('hidden');
                if (styleUploadPreview) styleUploadPreview.classList.add('hidden');
                if (styleImageInput) styleImageInput.value = '';
            });
        }

        // Intensity slider
        if (styleIntensity) {
            styleIntensity.addEventListener('input', function() {
                const value = this.value;
                if (intensityValue) intensityValue.textContent = value;

                // Update slider background
                const percentage = ((value - 1) / 9) * 100;
                this.style.background = `linear-gradient(to right, #6366f1 ${percentage}%, #2C2C2C ${percentage}%)`;
            });

            // Initialize slider
            styleIntensity.dispatchEvent(new Event('input'));
        }

        // File Upload Handling
        if (styleUploadArea) {
            styleUploadArea.addEventListener('click', (e) => {
                if (!e.target.closest('#removeUploadedStyle')) {
                    styleImageInput.click();
                }
            });

            styleUploadArea.addEventListener('dragover', (e) => {
                e.preventDefault();
                styleUploadArea.classList.add('drag-over');
            });

            styleUploadArea.addEventListener('dragleave', () => {
                styleUploadArea.classList.remove('drag-over');
            });

            styleUploadArea.addEventListener('drop', (e) => {
                e.preventDefault();
                styleUploadArea.classList.remove('drag-over');
                const files = e.dataTransfer.files;
                if (files.length > 0) {
                    handleStyleImageUpload(files[0]);
                }
            });
        }

        if (styleImageInput) {
            styleImageInput.addEventListener('change', (e) => {
                if (e.target.files.length > 0) {
                    handleStyleImageUpload(e.target.files[0]);
                }
            });
        }

        function handleStyleImageUpload(file) {
            if (file.type.startsWith('image/')) {
                const reader = new FileReader();
                reader.onload = (e) => {
                    // Update upload area preview
                    if (styleUploadPreviewImg) styleUploadPreviewImg.src = e.target.result;
                    if (styleUploadContent) styleUploadContent.classList.add('hidden');
                    if (styleUploadPreview) styleUploadPreview.classList.remove('hidden');

                    // Remove selection from example styles
                    styleOptions.forEach(opt => opt.classList.remove('selected'));

                    // Update selected style    
                    selectedStyle = {
                        id: 'uploaded',
                        name: 'Uploaded Image',
                        img: e.target.result,
                        isUploaded: true
                    };

                    updateFluxStyleUI();

                    // Close panel after upload
                    setTimeout(() => {
                        closeFluxStylePanel();
                    }, 300);
                };
                reader.readAsDataURL(file);
            }
        }

        if (removeUploadedStyle) {
            removeUploadedStyle.addEventListener('click', (e) => {
                e.stopPropagation();
                if (styleImageInput) styleImageInput.value = '';
                if (styleUploadContent) styleUploadContent.classList.remove('hidden');
                if (styleUploadPreview) styleUploadPreview.classList.add('hidden');

                // Only clear if current selection is uploaded
                if (selectedStyle && selectedStyle.isUploaded) {
                    selectedStyle = null;
                    updateFluxStyleUI();
                }
            });
        }

        // Close panel when clicking outside
        document.addEventListener('click', (e) => {
            if (isFluxStylePanelOpen &&
                fluxStylePanel &&
                !fluxStylePanel.contains(e.target) &&
                !e.target.closest('#fluxImageStyleSection')) {
                closeFluxStylePanel();
            }
        });

        // Close with Escape key
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape' && isFluxStylePanelOpen) {
                closeFluxStylePanel();
            }
        });

        // ================================================
        // END FLUX IMAGE STYLE PANEL FUNCTIONALITY
        // ================================================
        

        // Image count controls
        const decreaseCount = document.getElementById('decreaseCount');
        const increaseCount = document.getElementById('increaseCount');
        const imageCount = document.getElementById('imageCount');

        decreaseCount.addEventListener('click', () => {
            const current = parseInt(imageCount.value);
            if (current > 1) {
                imageCount.value = current - 1;
            }
        });

        increaseCount.addEventListener('click', () => {
            const current = parseInt(imageCount.value);
            if (current < 4) {
                imageCount.value = current + 1;
            }
        });

        // Generate button functionality
        const generateBtn = document.getElementById('generateBtn');
        const defaultState = document.getElementById('defaultState');
        const loadingState = document.getElementById('loadingState');
        const imageContainer = document.getElementById('imageContainer');
        const generatedImage = document.getElementById('generatedImage');

        generateBtn.addEventListener('click', function() {
            if (promptInput.value.trim() === '') {
                promptInput.focus();
                promptInput.classList.add('border-error');
                setTimeout(() => {
                    promptInput.classList.remove('border-error');
                }, 2000);
                return;
            }

           
        });

        // Clear all functionality
        const clearAllBtn = document.getElementById('clearAllBtn');
        clearAllBtn.addEventListener('click', function() {
            promptInput.value = '';
            charCount.textContent = '0/500';
            imageCount.value = '1';

            // Clear face lock
            faceLockImage.value = '';
            faceLockUploadContent.classList.remove('hidden');
            faceLockImagePreview.classList.add('hidden');
            faceLockDropZone.classList.add('hidden');
            faceLockBtn.classList.remove('bg-primary', 'text-white');
            faceLockBtn.querySelector('span').textContent = 'Face Lock';

            // Clear style selections
            if (selectedStyleExample) {
                selectedStyleExample.classList.remove('ring-2', 'ring-primary');
                selectedStyleExample = null;
            }

            // Clear style image upload
            styleImageInput.value = '';
            styleUploadContent.classList.remove('hidden');
            styleImagePreview.classList.add('hidden');

            // Reset to default state
            loadingState.classList.add('hidden');
            imageContainer.classList.add('hidden');
            defaultState.classList.remove('hidden');

            // Close flux panel if open
            if (isFluxPanelOpen) {
                closeFluxStylePanel();
            }

                 // ========== YENİ EKLENEN KISIM ==========
            // Reset model selection
            if (typeof clearAllSelectedModels === 'function') {
                clearAllSelectedModels();
            }

            // Close model panel if open
            if (isModelPanelOpen) {
                closeModelPanel();
            }
            // ========== YENİ EKLENEN KISIM SONU ==========

                    // ========== FLUX STYLE RESET ==========
            // Reset flux style selection
            selectedStyle = null;
            if (typeof updateSelectedStyleUI === 'function') {
                updateSelectedStyleUI();
            }
            if (styleOptions) {
                styleOptions.forEach(opt => opt.classList.remove('selected'));
            }
            if (styleUploadContent) styleUploadContent.classList.remove('hidden');
            if (styleUploadPreview) styleUploadPreview.classList.add('hidden');
            if (styleImageInput) styleImageInput.value = '';

            // Close flux style panel if open
            if (typeof isFluxStylePanelOpen !== 'undefined' && isFluxStylePanelOpen) {
                closeFluxStylePanel();
            }
            // ========== END FLUX STYLE RESET ==========

        });

        // Custom slider styling
        const sliders = document.querySelectorAll('input[type="range"]');
        sliders.forEach(slider => {
            slider.addEventListener('input', function() {
                const value = (this.value - this.min) / (this.max - this.min) * 100;
                this.style.background = `linear-gradient(to right, #6366f1 0%, #6366f1 ${value}%, #333333 ${value}%, #333333 100%)`;
            });

            // Initialize slider
            slider.dispatchEvent(new Event('input'));
        });

        // ================================================
        // MODEL SELECTION PANEL FUNCTIONALITY
        // ================================================

        const modelSelectBtn = document.getElementById('modelSelectBtn');
        const modelPanel = document.getElementById('modelPanel');
        const modelArrow = document.getElementById('modelArrow');
        const modelCategoryBtns = document.querySelectorAll('.model-category-btn');
        const modelContents = document.querySelectorAll('.model-content');
        const modelOptions = document.querySelectorAll('.model-option');
        const selectedModelValue = document.getElementById('selectedModelValue');
                
        const selectedModelBaseModel = document.getElementById('selectedModelBaseModel');
        const selectedModelName = document.getElementById('selectedModelName');

        const selectedModelText = document.getElementById('selectedModelText');
        const selectedModelsContainer = document.getElementById('selectedModelsContainer');
        const selectedModelsTags = document.getElementById('selectedModelsTags');
        const clearAllModelsBtn = document.getElementById('clearAllModelsBtn');

        let isModelPanelOpen = false;
        let selectedModels = []; // Array to store selected models

        function openModelPanel() {
            if (isModelPanelOpen) return;
            isModelPanelOpen = true;

            modelPanel.classList.remove('hidden');
            modelArrow.style.transform = 'rotate(180deg)';

            // Trigger animation
            setTimeout(() => {
                modelPanel.classList.add('open');
            }, 10);
        }

        function closeModelPanel() {
            if (!isModelPanelOpen) return;
            isModelPanelOpen = false;

            modelPanel.classList.remove('open');
            modelArrow.style.transform = 'rotate(0deg)';

            // Hide after animation
            setTimeout(() => {
                modelPanel.classList.add('hidden');
            }, 300);
        }

        // Toggle panel on button click
        if (modelSelectBtn) {
            modelSelectBtn.addEventListener('click', (e) => {
                e.preventDefault();
                if (isModelPanelOpen) {
                    closeModelPanel();
                } else {
                    openModelPanel();
                }
            });
        }

        // Category switching
        modelCategoryBtns.forEach(btn => {
            btn.addEventListener('click', function() {
                const category = this.dataset.category;

                // Update active state
                modelCategoryBtns.forEach(b => b.classList.remove('active'));
                this.classList.add('active');

                // Show corresponding content
                modelContents.forEach(content => {
                    content.classList.add('hidden');
                });
                const targetContent = document.getElementById(`${category}-content`);
                if (targetContent) {
                    targetContent.classList.remove('hidden');
                }
            });
        });

        // Render selected model tags
                // Render selected model tags
        function renderSelectedModelTags() {
            if (!selectedModelsTags) return;

            selectedModelsTags.innerHTML = '';

            if (selectedModels.length === 0) {
                selectedModelsContainer.classList.add('hidden');
                if (selectedModelText) {
                    selectedModelText.textContent = 'Select a model to start generating images';
                }
                if (selectedModelValue) {
                    selectedModelValue.value = '';
                }
                return;
            }

            selectedModelsContainer.classList.remove('hidden');

            selectedModels.forEach(model => {
                const tag = document.createElement('div');
                tag.className = 'selected-model-tag';

                // Shorten long names
                const shortName = model.name.length > 10 ? model.name.substring(0, 10) + '...' : model.name;

                tag.innerHTML = `
                    <img src="${model.img}" alt="${model.name}" />
                    <span title="${model.name}">${shortName}</span>
                    <button type="button" class="remove-tag" data-model="${model.name}">
                        <i class="fas fa-times"></i>
                    </button>
                `;
                selectedModelsTags.appendChild(tag);
            });

            // Update hidden input with all selected model IDs
            if (selectedModelValue) {
                selectedModelValue.value = selectedModels.map(m => m.id).join(',');
            }

            // Update button text
            if (selectedModelText) {
                selectedModelText.textContent = `${selectedModels.length} model${selectedModels.length > 1 ? 's' : ''} selected`;
            }

            // Add click handlers for remove buttons
            document.querySelectorAll('.remove-tag').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    e.stopPropagation();
                    const modelId = btn.dataset.model;
                    removeModel(modelId);
                });
            });
        }

        // Add model to selection
        function addModel(baseModel, modelName, modelImg) {
            // Check if already selected
        const existingIndex = selectedModels.findIndex(m => m.name === modelName);

            if (existingIndex > -1) {
                // If already selected, remove it (toggle behavior)
                selectedModels.splice(existingIndex, 1);
            } else {
                // Add new model
                selectedModels.push({
                    baseModel: baseModel,
                    name: modelName,
                    img: modelImg
                });
            }

            renderSelectedModelTags();
            updateModelOptionStates();
            updateHiddenInputs();
        }

        // Update hidden inputs for DTO binding
        function updateHiddenInputs() {
            if (selectedModels.length > 0) {
                // İlk seçilen modelin bilgilerini DTO'ya gönder
                const firstModel = selectedModels[0];
                if (selectedModelBaseModel) selectedModelBaseModel.value = firstModel.baseModel;
                if (selectedModelName) selectedModelName.value = firstModel.name;
                if (selectedModelValue) selectedModelValue.value = firstModel.name;
                } else {
                if (selectedModelBaseModel) selectedModelBaseModel.value = '';
                if (selectedModelName) selectedModelName.value = '';
                if (selectedModelValue) selectedModelValue.value = '';
            }
        }

        // Remove model from selection
        function removeModel(modelName) {
            selectedModels = selectedModels.filter(m => m.name !== modelName);
            renderSelectedModelTags();
            updateModelOptionStates();
            updateHiddenInputs();
        }

        // Update visual state of model options
        function updateModelOptionStates() {
            modelOptions.forEach(option => {
                const modelName = option.dataset.name;
                if (selectedModels.find(m => m.name === modelName)) {
                    option.classList.add('selected');
                } else {
                    option.classList.remove('selected');
                }
            });
        }

        // Clear all selected models
        function clearAllSelectedModels() {
            selectedModels = [];
            renderSelectedModelTags();
            updateModelOptionStates();
            updateHiddenInputs();
        }

        // Model option selection
        modelOptions.forEach(option => {
        option.addEventListener('click', function() {
            const baseModel = this.dataset.baseModel || this.dataset.model; // Eski format için fallback
            const modelName = this.dataset.name;
            const modelImg = this.dataset.img;

            addModel(baseModel, modelName, modelImg);

                // Visual feedback
                const imgContainer = this.querySelector('div');
                if (imgContainer) {
                    imgContainer.style.transform = 'scale(0.95)';
                    setTimeout(() => {
                        imgContainer.style.transform = 'scale(1)';
                    }, 150);
                }
            });
        });

        // Clear all button
        if (clearAllModelsBtn) {
            clearAllModelsBtn.addEventListener('click', (e) => {
                e.stopPropagation();
                clearAllSelectedModels();
            });
        }

        // Close panel when clicking outside
        document.addEventListener('click', (e) => {
            if (isModelPanelOpen &&
                modelPanel &&
                modelSelectBtn &&
                !modelPanel.contains(e.target) &&
                !modelSelectBtn.contains(e.target) &&
                !e.target.closest('.selected-model-tag')) {
                closeModelPanel();
            }
        });

        // Close with Escape key
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape' && isModelPanelOpen) {
                closeModelPanel();
            }
        });

        // ================================================
        // END MODEL SELECTION PANEL FUNCTIONALITY
        // ================================================

    </script>
    <script id="dhws-dataInjector" src="../public/dhws-data-injector.js"></script>
</body>
</html>